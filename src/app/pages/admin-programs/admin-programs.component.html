@if (programs != null) {
<app-inner-page-banner [pageTitle]="'الدورات التدريبية'"></app-inner-page-banner>

<div class="programs-container">
    <div class="container">
        <!-- Header Actions -->
        <div class="header-actions">
            <div class="actions-wrapper">
                <button [routerLink]="'/create-program'" class="action-btn primary-btn">
                    <i class="flaticon-plus"></i>
                    <span>إضافة تدريب جديد</span>
                </button>
                <button (click)="openModal()" class="action-btn secondary-btn">
                    <i class="flaticon-download"></i>
                    <span>استيراد حقيبة تدريبية</span>
                </button>
            </div>
        </div>

        @if (programs.length > 0) {
        <!-- Programs Grid -->
        <div class="programs-grid">
            @for (program of programs; track program) {
            <div class="program-card" [routerLink]="['/program-details', program.id]">
                <div class="card-image">
                    <img [src]="program.image" alt="program image" />
                    <div class="card-overlay">
                        <span class="view-details">عرض التفاصيل</span>
                    </div>
                </div>
                
                <div class="card-content">
                    <div class="instructor-info">
                        <div class="instructor-avatar">
                            <img [src]="program.coachImage ?? 'images/default-profile.png'" alt="instructor" />
                        </div>
                        <span class="instructor-name">{{program.coachName}}</span>
                    </div>
                    
                    <h3 class="program-title">{{ program.title }}</h3>
                    <p class="program-description">{{ program.details }}</p>
                    
                    <div class="program-meta">
                        <div class="meta-item">
                            <i class="flaticon-calendar"></i>
                            <span>{{ program.duration }} يوم</span>
                        </div>
                        <div class="meta-item">
                            <i class="flaticon-users"></i>
                            <span>متاح</span>
                        </div>
                    </div>
                    
                    <div class="card-actions">
                        <a [routerLink]="['/program/dashboard',program.id]" class="manage-btn" (click)="$event.stopPropagation()">
                            <i class="flaticon-settings"></i>
                            <span>إدارة التدريب</span>
                        </a>
                    </div>
                </div>
            </div>
            }
        </div>
        } @else {
        <!-- Empty State -->
        <div class="empty-state">
            <div class="empty-icon">
                <i class="flaticon-education"></i>
            </div>
            <h3 class="empty-title">لا توجد تدريبات متاحة حالياً</h3>
            <p class="empty-description">ابدأ بإضافة تدريب جديد أو استيراد حقيبة تدريبية موجودة</p>
            <button [routerLink]="'/create-program'" class="empty-action-btn">
                <i class="flaticon-plus"></i>
                <span>إضافة تدريب جديد</span>
            </button>
        </div>
        }
    </div>
</div>
}

<!-- Import Modal -->
<ng-template #ImportProgramModal let-modal>
    <div class="custom-modal">
        <div class="modal-header">
            <h4 class="modal-title">
                <i class="flaticon-download"></i>
                استيراد حقيبة تدريبية
            </h4>
            <button type="button" class="close-btn" (click)="modal.dismiss()">
                <i class="flaticon-close"></i>
            </button>
        </div>

        <div class="modal-body">
            <div class="form-group">
                <label class="form-label">مفتاح الاستيراد السري</label>
                <div class="input-wrapper">
                    <input 
                        type="text" 
                        class="form-input" 
                        [(ngModel)]="secretKey" 
                        name="secretKey" 
                        placeholder="أدخل مفتاح الاستيراد..."
                    />
                    <i class="flaticon-key input-icon"></i>
                </div>
            </div>
        </div>

        <div class="modal-footer">
            <button type="button" class="btn-cancel" (click)="modal.dismiss()">
                إلغاء
            </button>
            <button 
                type="button" 
                class="btn-import" 
                (click)="importProgram(secretKey)" 
                [disabled]="!secretKey"
            >
                <i class="flaticon-download"></i>
                استيراد
            </button>
        </div>
    </div>
</ng-template>

<ngx-spinner 
    bdColor="rgba(34, 22, 56, 0.8)" 
    size="default" 
    color="#ff5d22" 
    type="cube-transition" 
    [fullScreen]="true"
    [zIndex]="9999">
</ngx-spinner>